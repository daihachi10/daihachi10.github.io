<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify Album Tracks</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Spotify Album Tracks</h1>
    <button id="getTracks">Get Album Tracks</button>
    <div id="tracks"></div>

    <script>
        const clientId = '16917a0720ed455581341e184f7685b7';
        const clientSecret = '3b7c5eeb896c4e808ae7d4992b62c9c1';
        const albumId = '6T0D7fzbJin2P5VrzsAzZZ';

        async function getAccessToken() {
            try {
                const response = await fetch('https://accounts.spotify.com/api/token', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'Authorization': 'Basic ' + btoa(clientId + ':' + clientSecret)
                    },
                    body: 'grant_type=client_credentials'
                });
                const data = await response.json();
                return data.access_token;
            } catch (error) {
                console.error('Error fetching access token:', error);
            }
        }

        async function getAlbumTracks(token) {
            try {
                const settings = {
                    "url": `https://api.spotify.com/v1/albums/${albumId}/tracks`,
                    "method": "GET",
                    "timeout": 0,
                    "headers": {
                        "Authorization": `Bearer ${token}`
                    },
                };

                $.ajax(settings).done(function (response) {
                    console.log(response);
                    displayTracks(response);
                }).fail(function (jqXHR, textStatus, errorThrown) {
                    console.error('Error fetching album tracks:', textStatus, errorThrown);
                });
            } catch (error) {
                console.error('Error in getAlbumTracks function:', error);
            }
        }

        function displayTracks(tracks) {
            const tracksDiv = $('#tracks');
            tracksDiv.empty();
            tracks.items.forEach(track => {
                tracksDiv.append(`<p>${track.name}</p>`);
            });
        }

        $(document).ready(function() {
            $('#getTracks').on('click', async function() {
                const token = await getAccessToken();
                if (token) {
                    getAlbumTracks(token);
                } else {
                    console.error('Failed to retrieve access token.');
                }
            });
        });
    </script>
</body>
</html>
